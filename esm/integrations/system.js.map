{"version":3,"file":"system.js","sourceRoot":"","sources":["../../src/integrations/system.ts"],"names":[],"mappings":";AACA,OAAO,EAAE,uBAAuB,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AACtE,OAAO,EAAE,OAAO,IAAI,cAAc,EAAE,GAAG,EAAE,MAAM,kBAAkB,CAAC;AAElE,gBAAgB;AAChB;IAAA;QACE;;WAEG;QACI,SAAI,GAAW,MAAM,CAAC,EAAE,CAAC;IA8ElC,CAAC;IAvEC;;OAEG;IACI,0BAAS,GAAhB;QACE,uBAAuB,CAAC,UAAC,KAAY;YACnC,IAAI,aAAa,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC1C,IAAI;oBACF,IAAM,UAAU,GAAG,GAAG,CAAC,iBAAiB,EAAE,CAAC;oBAEzC,IAAA,KAqBE,UAAU,WArBQ,EAApB,UAAU,mBAAG,OAAO,KAAA,EACpB,YAAY,GAoBV,UAAU,aApBA,EAAE,QAAQ;oBACtB,cAAc,GAmBZ,UAAU,eAnBE,EAAE,gBAAgB;oBAChC,OAAO,GAkBL,UAAU,QAlBL,EAAE,UAAU;oBACnB,KAAK,GAiBH,UAAU,MAjBP,EACL,QAAQ,GAgBN,UAAU,SAhBJ,EACR,KAAK,GAeH,UAAU,MAfP,EACL,UAAU,GAcR,UAAU,WAdF,EACV,QAAQ,GAaN,UAAU,SAbJ,EACR,YAAY,GAYV,UAAU,aAZA,EACZ,WAAW,GAWT,UAAU,YAXD,EACX,eAAe,GAUb,UAAU,gBAVG,EACf,MAAM,GASJ,UAAU,OATN,EACN,OAAO,GAQL,UAAU,QARL,EACP,YAAY,GAOV,UAAU,aAPA,EACZ,WAAW,GAMT,UAAU,YAND,EACX,UAAU,GAKR,UAAU,WALF,EAAE,UAAU;oBACtB,GAAG,GAID,UAAU,IAJT,EAAE,SAAS;oBACd,OAAO,GAGL,UAAU,QAHL,EAAE,UAAU;oBACnB,OAAO,GAEL,UAAU,QAFL,EAAE,gBAAgB;oBACzB,eAAe,GACb,UAAU,gBADG,CAAC,sBAAsB;oBAAvB,CACF;oBACT,IAAA,KAAA,OAA8B,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAA,EAA9C,UAAU,QAAA,EAAE,aAAa,QAAqB,CAAC;oBACtD,6BACK,KAAK,KACR,QAAQ,wBACH,KAAK,CAAC,QAAQ,KACjB,MAAM,EAAE;gCACN,KAAK,OAAA;gCACL,aAAa,EAAE,YAAY,IAAI,cAAc,IAAI,OAAO,IAAI,CAAC;gCAC7D,KAAK,OAAA;gCACL,UAAU,EAAE,UAAU;6BACvB,EACD,EAAE,EAAE;gCACF,IAAI,EAAE,UAAU,IAAI,MAAM;gCAC1B,OAAO,EAAE,aAAa,IAAI,MAAM;6BACjC,EACD,KAAK,EAAE;gCACL,UAAU,YAAA;gCACV,QAAQ,UAAA;gCACR,QAAQ,UAAA;gCACR,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,eAAe,iBAAA;gCACf,OAAO,SAAA;gCACP,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,UAAU,YAAA;gCACV,eAAe,iBAAA;gCACf,OAAO,SAAA;gCACP,GAAG,EAAE,GAAG,IAAI,OAAO,IAAI,cAAc;6BACtC,OAEH;iBACH;gBAAC,OAAO,CAAC,EAAE;oBACV,OAAO,CAAC,IAAI,CAAC,0CAAwC,CAAG,CAAC,CAAC;iBAC3D;aACF;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CAAC;IACL,CAAC;IA3ED;;OAEG;IACW,SAAE,GAAW,QAAQ,CAAC;IAyEtC,aAAC;CAAA,AAlFD,IAkFC;SAlFY,MAAM","sourcesContent":["import { Event, Integration } from \"@sentry/types\";\nimport { addGlobalEventProcessor, getCurrentHub } from \"@sentry/core\";\nimport { appName as currentAppName, sdk } from \"../crossPlatform\";\n\n/** UserAgent */\nexport class System implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = System.id;\n\n  /**\n   * @inheritDoc\n   */\n  public static id: string = \"System\";\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event) => {\n      if (getCurrentHub().getIntegration(System)) {\n        try {\n          const systemInfo = sdk.getSystemInfoSync();\n          const {\n            SDKVersion = \"0.0.0\",\n            batteryLevel, // 微信小程序\n            currentBattery, // 支付宝小程序、 钉钉小程序\n            battery, // 字节跳动小程序\n            brand,\n            language,\n            model,\n            pixelRatio,\n            platform,\n            screenHeight,\n            screenWidth,\n            statusBarHeight,\n            system,\n            version,\n            windowHeight,\n            windowWidth,\n            wifiSignal, // 字节跳动小程序\n            app, // 支付宝小程序\n            appName, // 字节跳动小程序\n            storage, // 支付宝小程序、 钉钉小程序\n            fontSizeSetting // 支付宝小程序、 钉钉小程序、微信小程序\n          } = systemInfo;\n          const [systemName, systemVersion] = system.split(\" \");\n          return {\n            ...event,\n            contexts: {\n              ...event.contexts,\n              device: {\n                brand,\n                battery_level: batteryLevel || currentBattery || battery || 0,\n                model,\n                screen_dpi: pixelRatio\n              },\n              os: {\n                name: systemName || system,\n                version: systemVersion || system\n              },\n              extra: {\n                SDKVersion,\n                language,\n                platform,\n                screenHeight,\n                screenWidth,\n                statusBarHeight,\n                version,\n                windowHeight,\n                windowWidth,\n                wifiSignal,\n                fontSizeSetting,\n                storage,\n                app: app || appName || currentAppName\n              }\n            }\n          };\n        } catch (e) {\n          console.warn(`sentry-miniapp get system info fail: ${e}`);\n        }\n      }\n\n      return event;\n    });\n  }\n}\n"]}