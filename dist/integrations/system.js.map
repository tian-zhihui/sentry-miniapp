{"version":3,"file":"system.js","sourceRoot":"","sources":["../../src/integrations/system.ts"],"names":[],"mappings":";;;AACA,qCAAsE;AACtE,kDAAkE;AAElE,gBAAgB;AAChB;IAAA;QACE;;WAEG;QACI,SAAI,GAAW,MAAM,CAAC,EAAE,CAAC;IA2ElC,CAAC;IApEC;;OAEG;IACI,0BAAS,GAAhB;QACE,8BAAuB,CAAC,UAAC,KAAY;YACnC,IAAI,oBAAa,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC1C,IAAI;oBACF,IAAM,UAAU,GAAG,mBAAG,CAAC,iBAAiB,EAAE,CAAC;oBAEzC,IAAA,KAmBE,UAAU,WAnBQ,EAApB,UAAU,mBAAG,OAAO,KAAA,EACpB,YAAY,GAkBV,UAAU,aAlBA,EAAE,QAAQ;oBACtB,cAAc,GAiBZ,UAAU,eAjBE,EAAE,gBAAgB;oBAChC,OAAO,GAgBL,UAAU,QAhBL,EAAE,UAAU;oBACnB,KAAK,GAeH,UAAU,MAfP,EACL,QAAQ,GAcN,UAAU,SAdJ,EACR,KAAK,GAaH,UAAU,MAbP,EACL,UAAU,GAYR,UAAU,WAZF,EACV,QAAQ,GAWN,UAAU,SAXJ,EACR,YAAY,GAUV,UAAU,aAVA,EACZ,WAAW,GAST,UAAU,YATD,EACX,eAAe,GAQb,UAAU,gBARG,EACf,MAAM,GAOJ,UAAU,OAPN,EACN,OAAO,GAML,UAAU,QANL,EACP,YAAY,GAKV,UAAU,aALA,EACZ,WAAW,GAIT,UAAU,YAJD,EACX,GAAG,GAGD,UAAU,IAHT,EAAE,SAAS;oBACd,OAAO,GAEL,UAAU,QAFL,EAAE,UAAU;oBACnB,eAAe,GACb,UAAU,gBADG,CACF;oBACT,IAAA,KAAA,eAA8B,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAA,EAA9C,UAAU,QAAA,EAAE,aAAa,QAAqB,CAAC;oBACtD,6CACK,KAAK,KACR,QAAQ,wCACH,KAAK,CAAC,QAAQ,KACjB,MAAM,EAAE;gCACN,KAAK,OAAA;gCACL,aAAa,EAAE,YAAY,IAAI,cAAc,IAAI,OAAO,IAAI,CAAC;gCAC7D,KAAK,OAAA;gCACL,UAAU,EAAE,UAAU;6BACvB,EACD,EAAE,EAAE;gCACF,IAAI,EAAE,UAAU,IAAI,MAAM;gCAC1B,OAAO,EAAE,aAAa,IAAI,MAAM;6BACjC,EACD,KAAK,qBACH,UAAU,YAAA;gCACV,QAAQ,UAAA;gCACR,QAAQ,UAAA;gCACR,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,eAAe,iBAAA;gCACf,OAAO,SAAA;gCACP,YAAY,cAAA;gCACZ,WAAW,aAAA;gCACX,eAAe,iBAAA,EACf,GAAG,EAAE,GAAG,IAAI,OAAO,IAAI,uBAAc,IAClC,UAAU,QAGjB;iBACH;gBAAC,OAAO,CAAC,EAAE;oBACV,OAAO,CAAC,IAAI,CAAC,0CAAwC,CAAG,CAAC,CAAC;iBAC3D;aACF;YAED,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CAAC;IACL,CAAC;IAxED;;OAEG;IACW,SAAE,GAAW,QAAQ,CAAC;IAsEtC,aAAC;CAAA,AA/ED,IA+EC;AA/EY,wBAAM","sourcesContent":["import { Event, Integration } from \"@sentry/types\";\nimport { addGlobalEventProcessor, getCurrentHub } from \"@sentry/core\";\nimport { appName as currentAppName, sdk } from \"../crossPlatform\";\n\n/** UserAgent */\nexport class System implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = System.id;\n\n  /**\n   * @inheritDoc\n   */\n  public static id: string = \"System\";\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event) => {\n      if (getCurrentHub().getIntegration(System)) {\n        try {\n          const systemInfo = sdk.getSystemInfoSync();\n          const {\n            SDKVersion = \"0.0.0\",\n            batteryLevel, // 微信小程序\n            currentBattery, // 支付宝小程序、 钉钉小程序\n            battery, // 字节跳动小程序\n            brand,\n            language,\n            model,\n            pixelRatio,\n            platform,\n            screenHeight,\n            screenWidth,\n            statusBarHeight,\n            system,\n            version,\n            windowHeight,\n            windowWidth,\n            app, // 支付宝小程序\n            appName, // 字节跳动小程序\n            fontSizeSetting, // 支付宝小程序、 钉钉小程序、微信小程序\n          } = systemInfo;\n          const [systemName, systemVersion] = system.split(\" \");\n          return {\n            ...event,\n            contexts: {\n              ...event.contexts,\n              device: {\n                brand,\n                battery_level: batteryLevel || currentBattery || battery || 0,\n                model,\n                screen_dpi: pixelRatio\n              },\n              os: {\n                name: systemName || system,\n                version: systemVersion || system\n              },\n              extra: {\n                SDKVersion,\n                language,\n                platform,\n                screenHeight,\n                screenWidth,\n                statusBarHeight,\n                version,\n                windowHeight,\n                windowWidth,\n                fontSizeSetting,\n                app: app || appName || currentAppName,\n                ...systemInfo,\n              }\n            }\n          };\n        } catch (e) {\n          console.warn(`sentry-miniapp get system info fail: ${e}`);\n        }\n      }\n\n      return event;\n    });\n  }\n}\n"]}